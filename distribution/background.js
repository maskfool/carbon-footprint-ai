var n=Object.defineProperty;var d=(e,t,a)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a;var r=(e,t,a)=>d(e,typeof t!="symbol"?t+"":t,a);class c{constructor(){r(this,"tabStats",{});r(this,"currentTabId",null);this.setupMessageHandlers(),this.setupTabListeners()}setupMessageHandlers(){chrome.runtime.onMessage.addListener((t,a,s)=>{var b;switch(t.action){case"getTabId":s({tabId:((b=a.tab)==null?void 0:b.id)||0});break;case"updateStats":this.updateTabStats(t.tabId,t.stats),s({success:!0});break;case"getStats":const i=this.getTabStats(t.tabId);s({stats:i});break;case"resetStats":this.resetTabStats(t.tabId),s({success:!0});break;case"getAllStats":s({stats:this.tabStats});break;default:s({error:"Unknown action"})}})}setupTabListeners(){chrome.tabs.onActivated.addListener(t=>{this.currentTabId=t.tabId}),chrome.tabs.onRemoved.addListener(t=>{delete this.tabStats[t]}),chrome.webNavigation.onBeforeNavigate.addListener(t=>{t.frameId===0&&this.resetTabStats(t.tabId)})}updateTabStats(t,a){this.tabStats[t]={...a,lastUpdated:Date.now()}}getTabStats(t){return this.tabStats[t]||null}resetTabStats(t){this.tabStats[t]&&(this.tabStats[t]={domain:this.tabStats[t].domain,totalBytes:0,lastUpdated:Date.now(),entryCount:0,entries:[]})}getCurrentTabStats(){return this.currentTabId?this.getTabStats(this.currentTabId):null}}const u=new c;globalThis.backgroundManager=u;
